    <script>
        document.addEventListener('DOMContentLoaded', function () {
            
            // --- ELEMENTOS DEL DOM ---
            const body = document.body;
            const book = document.getElementById('book');
            const prevBtn = document.getElementById('prev-page-btn');
            const nextBtn = document.getElementById('next-page-btn');
            const zoomBtn = document.getElementById('zoom-btn');
            
            const expandIcon = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M7 14H5v5h5v-2H7v-3zm-2-4h2V7h3V5H5v5zm12 2h-2v3h-3v2h5v-5zm-3-2V7h-2V5h5v5h-3z"/></svg>`;
            const collapseIcon = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M5 16h3v3h2v-5H5v2zm3-8H5v2h5V5H8v3zm6 11h2v-3h3v-2h-5v5zm2-11V5h-2v5h5V8h-3z"/></svg>`;

            let hojas = [];
            let pliegoActual = 0;

            // --- FUNCIÓN PARA CARGAR LA CONFIGURACIÓN Y CREAR EL ÁLBUM ---
            async function inicializarAlbum() {
                try {
                    const response = await fetch('config.json');
                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }
                    const config = await response.json();
                    crearAlbum(config);
                } catch (error) {
                    console.error("No se pudo cargar la configuración del álbum:", error);
                    // Opcional: Mostrar un mensaje de error al usuario en la página
                }
            }

            function crearAlbum(config) {
                const { ruta_imagenes, portada, contraportada, pliegos: imagenesPliegos } = config;

                book.innerHTML = '';
                hojas = [];
                pliegoActual = 0;

                const hojaPortada = document.createElement('div');
                hojaPortada.classList.add('page');
                hojaPortada.innerHTML = `
                    <div class="page-side front page-cover" style="background-image: url('${ruta_imagenes}${portada}');"></div>
                    <div class="page-side back page-spread left-side" style="background-image: url('${ruta_imagenes}${imagenesPliegos[0]}');"></div>
                `;
                hojas.push(hojaPortada);

                for (let i = 0; i < imagenesPliegos.length; i++) {
                    const hoja = document.createElement('div');
                    hoja.classList.add('page');
                    
                    const anverso = `<div class="page-side front page-spread right-side" style="background-image: url('${ruta_imagenes}${imagenesPliegos[i]}');"></div>`;
                    
                    let reverso;
                    if (i < imagenesPliegos.length - 1) {
                        reverso = `<div class="page-side back page-spread left-side" style="background-image: url('${ruta_imagenes}${imagenesPliegos[i + 1]}');"></div>`;
                    } else {
                        reverso = `<div class="page-side back page-cover" style="background-image: url('${ruta_imagenes}${contraportada}');"></div>`;
                    }
                    
                    hoja.innerHTML = anverso + reverso;
                    hojas.push(hoja);
                }

                for (let i = 0; i < hojas.length; i++) {
                    const hoja = hojas[i];
                    hoja.style.zIndex = hojas.length - i;
                    
                    const zOffset = (hojas.length - i) * 0.4;
                    hoja.style.setProperty('--z-offset', zOffset);
                    
                    book.appendChild(hoja);
                }
            }

            function pasarPliego() {
                if (pliegoActual >= hojas.length) return;
                const hojaQueGira = hojas[pliegoActual];
                hojaQueGira.style.zIndex = 1000;
                hojaQueGira.classList.add('flipped');
                
                setTimeout(() => {
                    hojaQueGira.style.zIndex = pliegoActual;
                }, 1200);

                pliegoActual++;
            }

            function retrocederPliego() {
                if (pliegoActual <= 0) return;
                pliegoActual--;
                const hojaQueGira = hojas[pliegoActual];
                hojaQueGira.style.zIndex = 1000;
                hojaQueGira.classList.remove('flipped');
                
                setTimeout(() => {
                    hojaQueGira.style.zIndex = hojas.length - pliegoActual;
                }, 1200);
            }
            
            function toggleZoom() {
                body.classList.toggle('album-zoomed');
                if (body.classList.contains('album-zoomed')) {
                    zoomBtn.innerHTML = collapseIcon;
                } else {
                    zoomBtn.innerHTML = expandIcon;
                }
            }
            
            // --- INICIALIZACIÓN ---
            inicializarAlbum();
            nextBtn.addEventListener('click', pasarPliego);
            prevBtn.addEventListener('click', retrocederPliego);
            zoomBtn.addEventListener('click', toggleZoom);
        });
    </script>